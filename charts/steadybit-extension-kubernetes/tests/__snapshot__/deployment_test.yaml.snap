manifest should match snapshot using podAnnotations and Labels:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations:
        some-deploy-annotation: some-deploy-annotation-value
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
            some-annotation: some-annotation-value
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            some-label: some-label-value
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with TLS:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_TLS_SERVER_CERT
                  value: /etc/extension/certificates/server-cert/tls.crt
                - name: STEADYBIT_EXTENSION_TLS_SERVER_KEY
                  value: /etc/extension/certificates/server-cert/tls.key
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts:
                - mountPath: /etc/extension/certificates/server-cert
                  name: certificate-server-cert
                  readOnly: true
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes:
            - name: certificate-server-cert
              secret:
                optional: false
                secretName: server-cert
manifest should match snapshot with attribute excluded:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_CONTAINER
                  value: k8s.label.*,attribute.123.container
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_DAEMON_SET
                  value: k8s.label.*,attribute.123.daemonSet
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_DEPLOYMENT
                  value: k8s.label.*,attribute.123.deployment
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_INGRESS
                  value: k8s.label.*,attribute.123.ingress
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_NODE
                  value: k8s.label.*,attribute.123.node
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_POD
                  value: k8s.label.*,attribute.123.pod
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_REPLICA_SET
                  value: k8s.label.*,attribute.123.replicaSet
                - name: STEADYBIT_EXTENSION_DISCOVERY_ATTRIBUTES_EXCLUDES_STATEFUL_SET
                  value: k8s.label.*,attribute.123.statefulSet
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with clusterName from parent chart:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with disabled discoveries:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with disabled excludes:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with extra env vars:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
                - name: FOO
                  value: bar
              envFrom:
                - configMapRef: null
                  name: env-configmap
                - name: env-secrets
                  secretRef: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with extra labels:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
        tags.datadoghq.com/service: steadybit-extension
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
            tags.datadoghq.com/service: steadybit-extension
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with mutual TLS:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_TLS_SERVER_CERT
                  value: /etc/extension/certificates/server-cert/tls.crt
                - name: STEADYBIT_EXTENSION_TLS_SERVER_KEY
                  value: /etc/extension/certificates/server-cert/tls.key
                - name: STEADYBIT_EXTENSION_TLS_CLIENT_CAS
                  value: /etc/extension/certificates/client-cert-a/tls.crt,/etc/extension/certificates/client-cert-a/tls.crt
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts:
                - mountPath: /etc/extension/certificates/client-cert-a
                  name: certificate-client-cert-a
                  readOnly: true
                - mountPath: /etc/extension/certificates/server-cert
                  name: certificate-server-cert
                  readOnly: true
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes:
            - name: certificate-client-cert-a
              secret:
                optional: false
                secretName: client-cert-a
            - name: certificate-server-cert
              secret:
                optional: false
                secretName: server-cert
manifest should match snapshot with mutual TLS using containerPaths:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_TLS_SERVER_CERT
                  value: /etc/tls/server.crt
                - name: STEADYBIT_EXTENSION_TLS_SERVER_KEY
                  value: /etc/tls/server.key
                - name: STEADYBIT_EXTENSION_TLS_CLIENT_CAS
                  value: /etc/tls/ca.crt,/etc/tls/ca2.crt
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with podSecurityContext:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            runAsUser: 2222
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot with priority class:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          priorityClassName: my-priority-class
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
manifest should match snapshot without TLS:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: '*'
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: null
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
should disable advice:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_DISABLE_ADVICE
                  value: "true"
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
should disable advice with old settings:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_DISABLE_ADVICE
                  value: "true"
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
should enable specific advice with exlude:
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        steadybit.com/discovery-disabled: "true"
        steadybit.com/extension: "true"
      name: RELEASE-NAME-steadybit-extension-kubernetes
      namespace: NAMESPACE
    spec:
      replicas: 1
      selector:
        matchLabels:
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: steadybit-extension-kubernetes
      template:
        metadata:
          annotations:
            oneagent.dynatrace.com/injection: "false"
          labels:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/name: steadybit-extension-kubernetes
            steadybit.com/discovery-disabled: "true"
            steadybit.com/extension: "true"
        spec:
          automountServiceAccountToken: true
          containers:
            - env:
                - name: STEADYBIT_LOG_LEVEL
                  value: INFO
                - name: STEADYBIT_LOG_FORMAT
                  value: text
                - name: STEADYBIT_EXTENSION_CLUSTER_NAME
                  value: test
                - name: STEADYBIT_EXTENSION_DISABLE_DISCOVERY_EXCLUDES
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CLUSTER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_CONTAINER
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DAEMON_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_DEPLOYMENT
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_INGRESS
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_NODE
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_POD
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_ARGO_ROLLOUT
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_REPLICA_SET
                  value: "true"
                - name: STEADYBIT_EXTENSION_DISCOVERY_DISABLED_STATEFUL_SET
                  value: "false"
                - name: STEADYBIT_EXTENSION_DISCOVERY_MAX_POD_COUNT
                  value: "50"
                - name: STEADYBIT_EXTENSION_DISCOVERY_REFRESH_THROTTLE
                  value: "20"
                - name: STEADYBIT_EXTENSION_ACTIVE_ADVICE_LIST
                  value: id1,id2,id3
                - name: STEADYBIT_EXTENSION_ADVICE_EXCLUDE_QUERY
                  value: k8s.namespace != "kube-system"
              image: ghcr.io/steadybit/extension-kubernetes:v0.0.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 5
                httpGet:
                  path: /health/liveness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 5
              name: extension
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/readiness
                  port: 8089
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  cpu: 500m
                  memory: 256Mi
                requests:
                  cpu: 50m
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              volumeMounts: null
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: steadybit-extension-kubernetes
          volumes: null
